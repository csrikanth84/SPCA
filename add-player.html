<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SPCA | Add Player</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header>
    <img src="logo_cleaned.png" alt="SPCA Logo" class="logo" />
    <h1>South Peninsula Cricket Association</h1>
    <p class="motto">One Team â€¢ One Dream</p>
</header>
<header><h1>Add New Player</h1></header>
<nav>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="team.html">Team</a></li>
    <li><a href="schedule.html">Schedule</a></li>
    <li><a href="gallery.html">Gallery</a></li>
    <li><a href="contact.html">Contact</a></li>
  </ul>
</nav>

<main>
  <section class="content">
    <form id="playerForm" class="player-form" enctype="multipart/form-data">
      <input type="text" name="firstName" id="firstName" placeholder="First Name" required>
      <input type="text" name="lastName" id="lastName" placeholder="Last Name" required>
      <input type="text" name="contactInfo" id="contactInfo" placeholder="Contact Info" required>
      <input type="text" name="emergencyContact" id="emergencyContact" placeholder="Emergency Contact Number" required>
      <input type="url" name="cricClubsLink" id="cricClubsLink" placeholder="CricClubs Profile Link" required>
      <label>Profile Picture: 
        <input type="file" name="profilePic" id="profilePic" accept="image/*" required>
      </label>
      <button type="submit" class="button">Save Player</button>
    </form>
  </section>
</main>

<footer>
  <p>&copy; 2024 South Peninsula Cricket Association | spcanet.com</p>
</footer>

<script>
  document.getElementById("playerForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    const form = document.getElementById("playerForm");
    const formData = new FormData(form);

    try {
      const response = await fetch("https://www.spcanet.com/api/add-player.php", {
        method: "POST",
        body: formData
      });

      const text = await response.text();
      console.log("Raw response:", text);

      let result;
      try {
        result = JSON.parse(text);
      } catch (err) {
        alert("Invalid JSON response from server.");
        return;
      }

      if (result.success) {
        alert("Player added successfully!");
        window.location.href = "team.html";
      } else {
        alert("Error: " + result.message);
      }
    } catch (error) {
      alert("Failed to save player: " + error);
    }
  });
</script>
</body>
</html>
