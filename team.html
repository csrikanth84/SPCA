<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SPCA | Team</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header>
    <img src="logo_cleaned.png" alt="SPCA Logo" class="logo" />
    <h1>South Peninsula Cricket Association</h1>
    <p class="motto">One Team â€¢ One Dream</p>
</header>
<header><h1>Our Team</h1></header>
<nav>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="team.html">Team</a></li>
    <li><a href="schedule.html">Schedule</a></li>
    <li><a href="gallery.html">Gallery</a></li>
    <li><a href="contact.html">Contact</a></li>
    <li><a href="add-player.html">Add Player</a></li>
  </ul>
</nav>

<main>
  <section class="content">
    <div id="playersContainer" class="players-grid">
      <p>Loading team members...</p>
    </div>
  </section>
</main>

<footer>
  <p>&copy; 2024 South Peninsula Cricket Association | spcanet.com</p>
</footer>

<script>
  async function loadPlayers() {
    const container = document.getElementById("playersContainer");
    try {
      const response = await fetch("get-players.php");
      if (!response.ok) {
        throw new Error(`Server responded with ${response.status} ${response.statusText}`);
      }

      let players;
      try {
        players = await response.json();
      } catch (jsonError) {
        throw new Error("Invalid JSON response from server.");
      }

      container.innerHTML = ""; // clear loading text

      if (!Array.isArray(players) || players.length === 0) {
        container.innerHTML = "<p>No players added yet.</p>";
        return;
      }

      players.forEach(player => {
        const card = document.createElement("div");
        card.className = "player-card";

        card.innerHTML = `
          <img src="${player.profilePic}" alt="${player.firstName} ${player.lastName}" class="player-pic" />
          <h3>${player.firstName} ${player.lastName}</h3>
          <p><strong>Contact:</strong> ${player.contactInfo}</p>
          <p><strong>Emergency:</strong> ${player.emergencyContact}</p>
          <p><a href="${player.cricClubsLink}" target="_blank">CricClubs Profile</a></p>
        `;
        container.appendChild(card);
      });
    } catch (error) {
      container.innerHTML = `<p style="color:red;">Failed to load players: ${error.message}</p>`;
    }
  }

  loadPlayers();
</script>
</body>
</html>
